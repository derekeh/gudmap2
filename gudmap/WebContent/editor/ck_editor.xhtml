<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ck="http://code.google.com/ck-jsf-editor">
	
<h:head>
	<title>GUDMAP Editor</title>
	  <!-- <h:outputStylesheet library="css" name="gudmap_db.css"></h:outputStylesheet>
	  <h:outputStylesheet library="css" name="gudmap100.css"></h:outputStylesheet> -->
	  <h:outputStylesheet library="css" name="gudmap.css"></h:outputStylesheet>
	  <h:outputScript library="scripts" name="jquery-latest.pack.js"></h:outputScript>
</h:head>
<f:event listener="#{loginBean.isEditor}" type="preRenderView" />
<h:body>
	<h1>Edit page: </h1> 
	<h:form id="il_pagelist">
		<h:selectOneMenu id="selectpage" value="#{paramBean.pageId}"
			valueChangeListener="#{paramBean.pageIdChanged}">
   			<f:selectItems value="#{paramBean.getPageIdlist()}" />
   			<f:ajax event="change" render=":editorForm:theEditor :editorForm:theHeader tmppage" execute="selectpage"></f:ajax>
   		</h:selectOneMenu> 
		<h:outputText id="tmppage" value="#{paramBean.pageId}"></h:outputText>
   	</h:form>
	 
	<h:form id="editorForm"> 
			<h:outputText value="Title:"></h:outputText>
			 <h:inputText id="theHeader" value="#{editPageBean.title}"></h:inputText>  
			 <br />     
	    	<ck:editor id="theEditor" value="#{editPageBean.value}"  uiColor="aed0ea" />
	    	
			<h:commandButton value="Save" action="#{editPageBean.updatePage}">
				<f:param name="pageId" value="#{paramBean.pageId}"></f:param>
			</h:commandButton>
			<br />
			<h:outputText value="#{editPageBean.status}"  />
		
		<!-- <h:messages id="messages" /> -->
	</h:form> 
	<hr />
	<h:form id="il_filelist">
	
	<h:selectOneMenu id="selectone" value="#{paramBean.imageDir}"
			valueChangeListener="#{paramBean.imageDirChanged}">
   			<f:selectItems value="#{paramBean.getImagedirlist()}" />
   			<f:ajax event="change" render="tmpimage il_imagelist" execute="selectone"></f:ajax>
   	</h:selectOneMenu>
   	
   	<h:outputText id="tmpimage" value="#{paramBean.imageDir}"></h:outputText>

	<h:dataTable id="il_imagelist" value="#{fileManagementBean.getImageList(paramBean.imageDir)}" var="u">
    		
 			<h:column >
    			<f:facet name="header">
    				<h:outputText value="Filename"></h:outputText>
    			</f:facet>
    				#{u.name}
    		</h:column>
    		<h:column >
    			<f:facet name="header">
    				<h:outputText value="Image"></h:outputText>
    			</f:facet>
    				<img src="#{u.baseUrl}#{paramBean.imageDir}/#{u.name}" />
    		</h:column>
    		
    		<h:column >
    			<f:facet name="header">
    				<h:outputText value="Width"></h:outputText>
    			</f:facet>
    				#{u.width} 
    		</h:column>
    		<h:column >
    			<f:facet name="header">
    				<h:outputText value="Height"></h:outputText>
    			</f:facet>
    				#{u.height}
    		</h:column>
    		<h:column >
    			<f:facet name="header">
    				<h:outputText value="URL"></h:outputText>
    			</f:facet>
    				<h:inputText size="70"  value="#{u.baseUrl}#{paramBean.imageDir}/#{u.name}"></h:inputText>
    		</h:column>
	</h:dataTable>
</h:form>

<script>
$(document).ready(function() {
    $('#form\\:theEditor').find('iframe').contents().find('body').css({
        'font-size': '10px',
        'color' : 'red'
    });
});
</script>

</h:body> 
</html>