<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ck="http://code.google.com/ck-jsf-editor">
	
<h:head>
	<title>GUDMAP Editor</title>
	  <!-- <h:outputStylesheet library="css" name="gudmap_db.css"></h:outputStylesheet>
	  <h:outputStylesheet library="css" name="gudmap100.css"></h:outputStylesheet> -->
	  <h:outputStylesheet library="css" name="gudmap.css"></h:outputStylesheet>
	  <h:outputScript library="scripts" name="jquery-latest.pack.js"></h:outputScript>
</h:head>
<f:event listener="#{loginBean.isEditor}" type="preRenderView" />
<h:body>

<h:panelGrid columns="3">
		<h:outputLink value="../db/index.jsf">
			<h:outputText value="Home" />
		</h:outputLink>
		<h:panelGroup></h:panelGroup>
		<h:outputLink value="../db/options.jsf">
			<h:outputText value="Options" />
		</h:outputLink>
	</h:panelGrid>
	
	<h1>Create page: </h1> 
	 
	<h:form id="editorForm"> 
			<h:outputText value="Category"></h:outputText>
			<h:selectOneMenu id="selectcategory" value="#{paramBean.pageCategory}"
					valueChangeListener="#{paramBean.pageCategoryChanged}">
		   			<f:selectItems value="#{paramBean.getPageCategorylist()}" />
		   	</h:selectOneMenu>
			<br /> 
			 <h:outputText value="Level"></h:outputText>
			 <h:inputText id="theLevel" value="#{createPageBean.level}" required="true" converterMessage="Must be a number!"></h:inputText> 
			 <h:message for="theLevel" /> 
			 <br /> 
			<h:outputText value="Alias"></h:outputText>
			 <h:inputText id="theAlias" value="#{createPageBean.alias}" required="true" requiredMessage="You must enter a String value!" 
			 				validator="#{createPageBean.validateAlias}"></h:inputText> 
			 <h:message for="theAlias" /> 
			 <br /> 
			<h:outputText value="Title:"></h:outputText>
			 <h:inputText id="theHeader" value="#{createPageBean.title}" required="true" requiredMessage="You must enter a String value!"></h:inputText> 
			 <h:message for="theHeader" /> 
			 <br />     
	    	<ck:editor id="theEditor" value="#{createPageBean.value}"  uiColor="aed0ea" />
	    	
			<h:commandButton value="Create Page" action="#{createPageBean.createPage}" />
			<br />
			<h:outputText value="#{createPageBean.status}&#160;&#160;&#160;"  />
			<h:outputLink value="../pages/viewPage.jsf?docID=#{createPageBean.lastInsert}"  rendered="#{createPageBean.lastInsert>0}">
				<h:outputText value="Go to page" />
			</h:outputLink>
		
		<!-- <h:messages id="messages" /> -->
	</h:form> 
	<hr />
	<h:form id="il_filelist">
	
	<h:selectOneMenu id="selectone" value="#{paramBean.imageDir}"
			valueChangeListener="#{paramBean.imageDirChanged}">
   			<f:selectItems value="#{paramBean.getImagedirlist()}" />
   			<f:ajax event="change" render="tmpimage il_imagelist" execute="selectone"></f:ajax>
   	</h:selectOneMenu>
   	
   	<h:outputText id="tmpimage" value="#{paramBean.imageDir}"></h:outputText>

	<h:dataTable id="il_imagelist" value="#{fileManagementBean.getImageList(paramBean.imageDir)}" var="u">
    		
 			<h:column >
    			<f:facet name="header">
    				<h:outputText value="Filename"></h:outputText>
    			</f:facet>
    				#{u.name}
    		</h:column>
    		<h:column >
    			<f:facet name="header">
    				<h:outputText value="Image"></h:outputText>
    			</f:facet>
    				<img src="#{u.baseUrl}#{paramBean.imageDir}/#{u.name}" />
    		</h:column>
    		
    		<h:column >
    			<f:facet name="header">
    				<h:outputText value="Width"></h:outputText>
    			</f:facet>
    				#{u.width} 
    		</h:column>
    		<h:column >
    			<f:facet name="header">
    				<h:outputText value="Height"></h:outputText>
    			</f:facet>
    				#{u.height}
    		</h:column>
    		<h:column >
    			<f:facet name="header">
    				<h:outputText value="URL"></h:outputText>
    			</f:facet>
    				<h:inputText size="70"  value="#{u.baseUrl}#{paramBean.imageDir}/#{u.name}"></h:inputText>
    		</h:column>
	</h:dataTable>
</h:form>

<script>
$(document).ready(function() {
    $('#form\\:theEditor').find('iframe').contents().find('body').css({
        'font-size': '10px',
        'color' : 'red'
    });
});
</script>

</h:body> 
</html>